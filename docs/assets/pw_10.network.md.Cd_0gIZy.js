import{_ as i,c as a,o as n,aN as t}from"./chunks/framework.0ZSa6Wd7.js";const o=JSON.parse('{"title":"ğŸ”µ ç½‘ç»œåŠŸèƒ½","description":"","frontmatter":{"id":"intro10","permalink":"/pw/intro10","title":"ğŸ”µ ç½‘ç»œåŠŸèƒ½"},"headers":[],"relativePath":"pw/10.network.md","filePath":"pw/10.network.md"}'),h={name:"pw/10.network.md"};function l(p,s,e,k,r,d){return n(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="playwright-python-ç½‘ç»œåŠŸèƒ½æ–‡æ¡£" tabindex="-1">Playwright Python ç½‘ç»œåŠŸèƒ½æ–‡æ¡£ <a class="header-anchor" href="#playwright-python-ç½‘ç»œåŠŸèƒ½æ–‡æ¡£" aria-label="Permalink to &quot;Playwright Python ç½‘ç»œåŠŸèƒ½æ–‡æ¡£&quot;">â€‹</a></h1><h2 id="ä¸€ã€ç®€ä»‹" tabindex="-1">ä¸€ã€ç®€ä»‹ <a class="header-anchor" href="#ä¸€ã€ç®€ä»‹" aria-label="Permalink to &quot;ä¸€ã€ç®€ä»‹&quot;">â€‹</a></h2><p>Playwright æä¾›äº†ç”¨äº<strong>ç›‘æ§</strong>å’Œ<strong>ä¿®æ”¹</strong>æµè§ˆå™¨ç½‘ç»œæµé‡çš„ APIï¼Œæ”¯æŒ HTTP å’Œ HTTPS åè®®ã€‚é¡µé¢å‘èµ·çš„æ‰€æœ‰è¯·æ±‚ï¼ˆåŒ…æ‹¬ XHR å’Œ fetch è¯·æ±‚ï¼‰éƒ½å¯è¢«è·Ÿè¸ªã€ä¿®æ”¹å’Œå¤„ç†ã€‚</p><p>æ­¤å¤–ï¼ŒPlaywright è¿˜æ”¯æŒç½‘ç»œç›¸å…³çš„æ‰©å±•èƒ½åŠ›ï¼Œå…·ä½“å¯å‚è€ƒï¼š</p><ul><li><a href="https://playwright.net.cn/python/docs/mock" target="_blank" rel="noreferrer">API æ¨¡æ‹ŸæŒ‡å—</a>ï¼šäº†è§£å¦‚ä½•æ¨¡æ‹Ÿ API è¯·æ±‚ï¼ˆæ— éœ€å®é™…å‘èµ·è¯·æ±‚ï¼‰ã€æ‰§è¡Œ API è¯·æ±‚å¹¶ä¿®æ”¹å“åº”ã€ä½¿ç”¨ HAR æ–‡ä»¶æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚ã€‚</li><li><a href="#å…«ã€WebSockets">WebSocket å¤„ç†</a>ï¼šå¼€ç®±å³ç”¨åœ°æ”¯æŒ WebSocket æ£€æŸ¥ã€æ¨¡æ‹Ÿå’Œä¿®æ”¹ã€‚</li></ul><h2 id="äºŒã€http-è®¤è¯" tabindex="-1">äºŒã€HTTP è®¤è¯ <a class="header-anchor" href="#äºŒã€http-è®¤è¯" aria-label="Permalink to &quot;äºŒã€HTTP è®¤è¯&quot;">â€‹</a></h2><p>é€šè¿‡é…ç½®æµè§ˆå™¨ä¸Šä¸‹æ–‡ï¼ˆBrowserContextï¼‰çš„ <code>http_credentials</code> å‚æ•°ï¼Œå¯è‡ªåŠ¨å¤„ç†éœ€è¦ HTTP è®¤è¯çš„é¡µé¢è®¿é—®ã€‚</p><h3 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ›å»ºå¸¦æœ‰ HTTP è®¤è¯ä¿¡æ¯çš„æµè§ˆå™¨ä¸Šä¸‹æ–‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.new_context(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    http_credentials</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bill&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pa55w0rd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»ä¸Šä¸‹æ–‡åˆ›å»ºæ–°é¡µé¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.new_page()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯¼èˆªåˆ°éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆä¼šè‡ªåŠ¨ä½¿ç”¨é…ç½®çš„ç”¨æˆ·åå’Œå¯†ç ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.goto(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥åˆ›å»ºå¸¦æœ‰ HTTP è®¤è¯ä¿¡æ¯çš„æµè§ˆå™¨ä¸Šä¸‹æ–‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.new_context(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    http_credentials</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bill&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pa55w0rd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥ä»ä¸Šä¸‹æ–‡åˆ›å»ºæ–°é¡µé¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.new_page()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥å¯¼èˆªåˆ°éœ€è¦è®¤è¯çš„é¡µé¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.goto(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="ä¸‰ã€http-ä»£ç†" tabindex="-1">ä¸‰ã€HTTP ä»£ç† <a class="header-anchor" href="#ä¸‰ã€http-ä»£ç†" aria-label="Permalink to &quot;ä¸‰ã€HTTP ä»£ç†&quot;">â€‹</a></h2><p>Playwright æ”¯æŒä¸ºæµè§ˆå™¨é…ç½® HTTP(S) ä»£ç†æˆ– SOCKSv5 ä»£ç†ï¼Œå¯é€šè¿‡ä¸¤ç§æ–¹å¼è®¾ç½®ï¼š</p><ol><li><strong>å…¨å±€ä»£ç†</strong>ï¼šä¸ºæ•´ä¸ªæµè§ˆå™¨å®ä¾‹è®¾ç½®ï¼Œæ‰€æœ‰ä¸Šä¸‹æ–‡å…±äº«ä»£ç†é…ç½®ï¼›</li><li><strong>ä¸Šä¸‹æ–‡ä»£ç†</strong>ï¼šä¸ºå•ä¸ªæµè§ˆå™¨ä¸Šä¸‹æ–‡è®¾ç½®ï¼Œä»…å½“å‰ä¸Šä¸‹æ–‡ç”Ÿæ•ˆã€‚</li></ol><p>åŒæ—¶ï¼Œå¯æŒ‡å®šä»£ç†çš„ç”¨æˆ·å/å¯†ç ï¼Œæˆ–é…ç½®æ— éœ€é€šè¿‡ä»£ç†çš„ä¸»æœºï¼ˆç»•è¿‡ä»£ç†ï¼‰ã€‚</p><h3 id="_1-å…¨å±€ä»£ç†é…ç½®" tabindex="-1">1. å…¨å±€ä»£ç†é…ç½® <a class="header-anchor" href="#_1-å…¨å±€ä»£ç†é…ç½®" aria-label="Permalink to &quot;1. å…¨å±€ä»£ç†é…ç½®&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-1" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-1" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯åŠ¨ Chromium æµè§ˆå™¨æ—¶é…ç½®å…¨å±€ä»£ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">browser </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chromium.launch(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;server&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://myproxy.com:3128&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»£ç†æœåŠ¡å™¨åœ°å€ï¼ˆæ ¼å¼ï¼šåè®®://åœ°å€:ç«¯å£ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;usr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»£ç†ç”¨æˆ·åï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pwd&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # ä»£ç†å¯†ç ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-1" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-1" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥å¯åŠ¨ Chromium æµè§ˆå™¨æ—¶é…ç½®å…¨å±€ä»£ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">browser </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chromium.launch(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;server&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://myproxy.com:3128&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;usr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;pwd&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="_2-ä¸Šä¸‹æ–‡ä»£ç†é…ç½®" tabindex="-1">2. ä¸Šä¸‹æ–‡ä»£ç†é…ç½® <a class="header-anchor" href="#_2-ä¸Šä¸‹æ–‡ä»£ç†é…ç½®" aria-label="Permalink to &quot;2. ä¸Šä¸‹æ–‡ä»£ç†é…ç½®&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-2" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-2" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…ˆå¯åŠ¨æ— ä»£ç†çš„æµè§ˆå™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">browser </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chromium.launch()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸ºå•ä¸ªä¸Šä¸‹æ–‡é…ç½®ä»£ç†ï¼ˆä»…å½“å‰ä¸Šä¸‹æ–‡ä½¿ç”¨è¯¥ä»£ç†ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.new_context(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;server&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://myproxy.com:3128&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-2" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-2" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥å¯åŠ¨æ— ä»£ç†çš„æµè§ˆå™¨å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">browser </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chromium.launch()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥ä¸ºå•ä¸ªä¸Šä¸‹æ–‡é…ç½®ä»£ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.new_context(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;server&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://myproxy.com:3128&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="å››ã€ç½‘ç»œäº‹ä»¶ç›‘æ§" tabindex="-1">å››ã€ç½‘ç»œäº‹ä»¶ç›‘æ§ <a class="header-anchor" href="#å››ã€ç½‘ç»œäº‹ä»¶ç›‘æ§" aria-label="Permalink to &quot;å››ã€ç½‘ç»œäº‹ä»¶ç›‘æ§&quot;">â€‹</a></h2><p>Playwright å¯ç›‘æ§é¡µé¢çš„<strong>è¯·æ±‚ï¼ˆrequestï¼‰</strong> å’Œ<strong>å“åº”ï¼ˆresponseï¼‰</strong> äº‹ä»¶ï¼Œä¹Ÿå¯ç­‰å¾…ç‰¹å®šå“åº”å®Œæˆï¼ˆå¦‚ç‚¹å‡»æŒ‰é’®åç­‰å¾… API å“åº”ï¼‰ã€‚</p><h3 id="_1-ç›‘æ§æ‰€æœ‰è¯·æ±‚ä¸å“åº”" tabindex="-1">1. ç›‘æ§æ‰€æœ‰è¯·æ±‚ä¸å“åº” <a class="header-anchor" href="#_1-ç›‘æ§æ‰€æœ‰è¯·æ±‚ä¸å“åº”" aria-label="Permalink to &quot;1. ç›‘æ§æ‰€æœ‰è¯·æ±‚ä¸å“åº”&quot;">â€‹</a></h3><p>é€šè¿‡ <code>page.on(&quot;request&quot;)</code> å’Œ <code>page.on(&quot;response&quot;)</code> è®¢é˜…äº‹ä»¶ï¼Œå®æ—¶æ‰“å°è¯·æ±‚æ–¹æ³•/URLã€å“åº”çŠ¶æ€ç /URLã€‚</p><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-3" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-3" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright.sync_api </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sync_playwright, Playwright</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(playwright: Playwright):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    chromium </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright.chromium</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¯åŠ¨æµè§ˆå™¨ï¼ˆé»˜è®¤æ— å¤´æ¨¡å¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    browser </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chromium.launch()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.new_page()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è®¢é˜…è¯·æ±‚äº‹ä»¶ï¼šæ‰“å°è¯·æ±‚æ–¹æ³•å’Œ URL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&gt;&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, request.method, request.url))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è®¢é˜…å“åº”äº‹ä»¶ï¼šæ‰“å°å“åº”çŠ¶æ€ç å’Œ URL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;response&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;&lt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, response.status, response.url))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¯¼èˆªåˆ°ç›®æ ‡é¡µé¢ï¼Œè§¦å‘ç½‘ç»œäº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page.goto(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å…³é—­æµè§ˆå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    browser.close()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆå§‹åŒ– Playwright å¹¶æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sync_playwright() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    run(playwright)</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-3" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-3" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asyncio</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright.async_api </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> async_playwright, Playwright</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(playwright: Playwright):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    chromium </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright.chromium</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¼‚æ­¥å¯åŠ¨æµè§ˆå™¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    browser </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chromium.launch()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.new_page()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è®¢é˜…è¯·æ±‚å’Œå“åº”äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;request&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&gt;&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, request.method, request.url))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;response&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;&lt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, response.status, response.url))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¼‚æ­¥å¯¼èˆªåˆ°ç›®æ ‡é¡µé¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.goto(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¼‚æ­¥å…³é—­æµè§ˆå™¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.close()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¼‚æ­¥åˆå§‹åŒ– Playwright å¹¶æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> async_playwright() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> run(playwright)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿è¡Œå¼‚æ­¥ä¸»å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">asyncio.run(main())</span></span></code></pre></div><h3 id="_2-ç­‰å¾…ç‰¹å®šå“åº”" tabindex="-1">2. ç­‰å¾…ç‰¹å®šå“åº” <a class="header-anchor" href="#_2-ç­‰å¾…ç‰¹å®šå“åº”" aria-label="Permalink to &quot;2. ç­‰å¾…ç‰¹å®šå“åº”&quot;">â€‹</a></h3><p>é€šè¿‡ <code>page.expect_response()</code> ç­‰å¾…ç¬¦åˆæ¡ä»¶çš„å“åº”ï¼ˆå¦‚ç‚¹å‡»æŒ‰é’®åè§¦å‘çš„ API è¯·æ±‚ï¼‰ï¼Œæ”¯æŒä¸‰ç§åŒ¹é…æ–¹å¼ï¼š</p><ul><li>Glob è·¯å¾„æ¨¡å¼ï¼ˆå¦‚ <code>**/api/fetch_data</code>ï¼‰ï¼›</li><li>æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¦‚ <code>re.compile(r&quot;\\.jpeg$&quot;)</code>ï¼‰ï¼›</li><li>è‡ªå®šä¹‰æ–­è¨€å‡½æ•°ï¼ˆå¦‚åˆ¤æ–­ URL åŒ…å«ç‰¹å®štokenï¼‰ã€‚</li></ul><h4 id="æ–¹å¼1-glob-è·¯å¾„æ¨¡å¼åŒ¹é…" tabindex="-1">æ–¹å¼1ï¼šGlob è·¯å¾„æ¨¡å¼åŒ¹é… <a class="header-anchor" href="#æ–¹å¼1-glob-è·¯å¾„æ¨¡å¼åŒ¹é…" aria-label="Permalink to &quot;æ–¹å¼1ï¼šGlob è·¯å¾„æ¨¡å¼åŒ¹é…&quot;">â€‹</a></h4><h5 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-4" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-4" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h5><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç­‰å¾… URL åŒ¹é… &quot;**/api/fetch_data&quot; çš„å“åº”ï¼ˆ** è¡¨ç¤ºä»»æ„å±‚çº§è·¯å¾„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.expect_response(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/api/fetch_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è§¦å‘è¯·æ±‚ï¼ˆå¦‚ç‚¹å‡»â€œæ›´æ–°â€æŒ‰é’®ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page.get_by_text(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Update&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).click()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è·å–å“åº”å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info.value</span></span></code></pre></div><h5 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-4" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-4" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h5><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥ç­‰å¾… URL åŒ¹é… &quot;**/api/fetch_data&quot; çš„å“åº”</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.expect_response(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/api/fetch_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¼‚æ­¥è§¦å‘è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.get_by_text(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Update&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).click()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥è·å–å“åº”å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info.value</span></span></code></pre></div><h4 id="æ–¹å¼2-æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…" tabindex="-1">æ–¹å¼2ï¼šæ­£åˆ™è¡¨è¾¾å¼åŒ¹é… <a class="header-anchor" href="#æ–¹å¼2-æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…" aria-label="Permalink to &quot;æ–¹å¼2ï¼šæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…&quot;">â€‹</a></h4><h5 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-5" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-5" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h5><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> re</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç­‰å¾… URL ä»¥ .jpeg ç»“å°¾çš„å“åº”ï¼ˆæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.expect_response(re.compile(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">jpeg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page.get_by_text(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Update&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).click()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info.value</span></span></code></pre></div><h5 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-5" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-5" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h5><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> re</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥ç­‰å¾… URL ä»¥ .jpeg ç»“å°¾çš„å“åº”</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.expect_response(re.compile(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">jpeg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.get_by_text(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Update&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).click()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info.value</span></span></code></pre></div><h4 id="æ–¹å¼3-è‡ªå®šä¹‰æ–­è¨€å‡½æ•°åŒ¹é…" tabindex="-1">æ–¹å¼3ï¼šè‡ªå®šä¹‰æ–­è¨€å‡½æ•°åŒ¹é… <a class="header-anchor" href="#æ–¹å¼3-è‡ªå®šä¹‰æ–­è¨€å‡½æ•°åŒ¹é…" aria-label="Permalink to &quot;æ–¹å¼3ï¼šè‡ªå®šä¹‰æ–­è¨€å‡½æ•°åŒ¹é…&quot;">â€‹</a></h4><h5 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-6" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-6" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h5><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">token </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;user123&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # å‡è®¾éœ€è¦åŒ¹é…çš„ token</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç­‰å¾… URL åŒ…å«æŒ‡å®š token çš„å“åº”ï¼ˆè‡ªå®šä¹‰æ–­è¨€å‡½æ•°ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.expect_response(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response: token </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.url) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    page.get_by_text(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Update&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).click()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info.value</span></span></code></pre></div><h5 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-6" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-6" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h5><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">token </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;user123&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥ç­‰å¾… URL åŒ…å«æŒ‡å®š token çš„å“åº”</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.expect_response(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response: token </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.url) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.get_by_text(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Update&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).click()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response_info.value</span></span></code></pre></div><h2 id="äº”ã€å¤„ç†è¯·æ±‚-æ¨¡æ‹Ÿ-api-ç«¯ç‚¹" tabindex="-1">äº”ã€å¤„ç†è¯·æ±‚ï¼ˆæ¨¡æ‹Ÿ API ç«¯ç‚¹ï¼‰ <a class="header-anchor" href="#äº”ã€å¤„ç†è¯·æ±‚-æ¨¡æ‹Ÿ-api-ç«¯ç‚¹" aria-label="Permalink to &quot;äº”ã€å¤„ç†è¯·æ±‚ï¼ˆæ¨¡æ‹Ÿ API ç«¯ç‚¹ï¼‰&quot;">â€‹</a></h2><p>é€šè¿‡ <code>page.route()</code> æˆ– <code>context.route()</code> æ‹¦æˆªç‰¹å®šè¯·æ±‚ï¼Œå¹¶è‡ªå®šä¹‰å“åº”å†…å®¹ï¼ˆå¦‚æ¨¡æ‹Ÿ API æˆåŠŸ/å¤±è´¥çŠ¶æ€ï¼‰ï¼Œæ— éœ€å®é™…å‘èµ·åç«¯è¯·æ±‚ã€‚</p><ul><li><code>page.route()</code>ï¼šä»…å¯¹å½“å‰é¡µé¢ç”Ÿæ•ˆï¼ŒåŒ…æ‹¬é¡µé¢å¼¹å‡ºçš„çª—å£å’Œé“¾æ¥ï¼›</li><li><code>context.route()</code>ï¼šå¯¹æ•´ä¸ªæµè§ˆå™¨ä¸Šä¸‹æ–‡ç”Ÿæ•ˆï¼Œæ‰€æœ‰ä»è¯¥ä¸Šä¸‹æ–‡åˆ›å»ºçš„é¡µé¢å…±äº«è·¯ç”±è§„åˆ™ã€‚</li></ul><h3 id="_1-é¡µé¢çº§è·¯ç”±-page-route" tabindex="-1">1. é¡µé¢çº§è·¯ç”±ï¼ˆpage.route()ï¼‰ <a class="header-anchor" href="#_1-é¡µé¢çº§è·¯ç”±-page-route" aria-label="Permalink to &quot;1. é¡µé¢çº§è·¯ç”±ï¼ˆpage.route()ï¼‰&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-7" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-7" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰æµ‹è¯•æ•°æ®ï¼ˆæ¨¡æ‹Ÿ API å“åº”ä½“ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;status&quot;: &quot;success&quot;, &quot;data&quot;: [1, 2, 3]}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‹¦æˆª URL åŒ¹é… &quot;**/api/fetch_data&quot; çš„è¯·æ±‚ï¼Œè¿”å›è‡ªå®šä¹‰å“åº”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.route(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;**/api/fetch_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åŒ¹é…è§„åˆ™ï¼ˆGlob æ¨¡å¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.fulfill(  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è‡ªå®šä¹‰å“åº”</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å“åº”çŠ¶æ€ç </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        body</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test_data,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å“åº”ä½“</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Content-Type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;application/json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å“åº”å¤´ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯¼èˆªåˆ°é¡µé¢ï¼Œè§¦å‘æ‹¦æˆªçš„è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.goto(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-7" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-7" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;status&quot;: &quot;success&quot;, &quot;data&quot;: [1, 2, 3]}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥æ‹¦æˆªè¯·æ±‚å¹¶è¿”å›è‡ªå®šä¹‰å“åº”</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.route(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;**/api/fetch_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.fulfill(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">body</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test_data, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Content-Type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;application/json&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥å¯¼èˆªåˆ°é¡µé¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.goto(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_2-ä¸Šä¸‹æ–‡çº§è·¯ç”±-context-route" tabindex="-1">2. ä¸Šä¸‹æ–‡çº§è·¯ç”±ï¼ˆcontext.route()ï¼‰ <a class="header-anchor" href="#_2-ä¸Šä¸‹æ–‡çº§è·¯ç”±-context-route" aria-label="Permalink to &quot;2. ä¸Šä¸‹æ–‡çº§è·¯ç”±ï¼ˆcontext.route()ï¼‰&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-8" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-8" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‹¦æˆªæ•´ä¸ªä¸Šä¸‹æ–‡å†… URL åŒ¹é… &quot;**/api/login&quot; çš„è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context.route(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;**/api/login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.fulfill(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">body</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;accept&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ¨¡æ‹Ÿç™»å½•æˆåŠŸå“åº”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä»ä¸Šä¸‹æ–‡åˆ›å»ºé¡µé¢å¹¶å¯¼èˆª</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.new_page()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.goto(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-8" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-8" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥æ‹¦æˆªä¸Šä¸‹æ–‡å†…çš„ç™»å½•è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.route(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;**/api/login&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.fulfill(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">body</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;accept&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥åˆ›å»ºé¡µé¢å¹¶å¯¼èˆª</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.new_page()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.goto(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="å…­ã€ä¿®æ”¹è¯·æ±‚" tabindex="-1">å…­ã€ä¿®æ”¹è¯·æ±‚ <a class="header-anchor" href="#å…­ã€ä¿®æ”¹è¯·æ±‚" aria-label="Permalink to &quot;å…­ã€ä¿®æ”¹è¯·æ±‚&quot;">â€‹</a></h2><p>é€šè¿‡ <code>route.continue_()</code> æ–¹æ³•ï¼Œå¯åœ¨æ‹¦æˆªè¯·æ±‚åä¿®æ”¹è¯·æ±‚å‚æ•°ï¼ˆå¦‚è¯·æ±‚å¤´ã€è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚ä½“ç­‰ï¼‰ï¼Œå†ç»§ç»­å‘èµ·è¯·æ±‚ã€‚</p><h3 id="ç¤ºä¾‹1-åˆ é™¤è¯·æ±‚å¤´" tabindex="-1">ç¤ºä¾‹1ï¼šåˆ é™¤è¯·æ±‚å¤´ <a class="header-anchor" href="#ç¤ºä¾‹1-åˆ é™¤è¯·æ±‚å¤´" aria-label="Permalink to &quot;ç¤ºä¾‹1ï¼šåˆ é™¤è¯·æ±‚å¤´&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-9" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-9" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰è·¯ç”±å¤„ç†å‡½æ•°ï¼šåˆ é™¤è¯·æ±‚å¤´ä¸­çš„ &quot;x-secret&quot; å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handle_route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(route):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è·å–åŸå§‹è¯·æ±‚å¤´</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    headers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.request.headers</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # åˆ é™¤æ•æ„Ÿå¤´ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;x-secret&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> headers:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        del</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> headers[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x-secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ç»§ç»­å‘èµ·è¯·æ±‚ï¼ˆä½¿ç”¨ä¿®æ”¹åçš„è¯·æ±‚å¤´ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    route.continue_(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">headers)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼ˆ**/* åŒ¹é…æ‰€æœ‰ URLï¼‰ï¼Œåº”ç”¨å¤„ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.route(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handle_route)</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-9" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-9" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥å®šä¹‰è·¯ç”±å¤„ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handle_route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(route):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    headers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.request.headers</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;x-secret&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> headers:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        del</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> headers[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x-secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¼‚æ­¥ç»§ç»­å‘èµ·è¯·æ±‚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.continue_(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">headers)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥æ‹¦æˆªæ‰€æœ‰è¯·æ±‚å¹¶åº”ç”¨å¤„ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.route(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handle_route)</span></span></code></pre></div><h3 id="ç¤ºä¾‹2-ä¿®æ”¹è¯·æ±‚æ–¹æ³•" tabindex="-1">ç¤ºä¾‹2ï¼šä¿®æ”¹è¯·æ±‚æ–¹æ³• <a class="header-anchor" href="#ç¤ºä¾‹2-ä¿®æ”¹è¯·æ±‚æ–¹æ³•" aria-label="Permalink to &quot;ç¤ºä¾‹2ï¼šä¿®æ”¹è¯·æ±‚æ–¹æ³•&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-10" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-10" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œå°†è¯·æ±‚æ–¹æ³•æ”¹ä¸º POST</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.route(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.continue_(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-10" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-10" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œä¿®æ”¹è¯·æ±‚æ–¹æ³•ä¸º POST</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.route(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.continue_(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><h2 id="ä¸ƒã€ä¸­æ­¢è¯·æ±‚" tabindex="-1">ä¸ƒã€ä¸­æ­¢è¯·æ±‚ <a class="header-anchor" href="#ä¸ƒã€ä¸­æ­¢è¯·æ±‚" aria-label="Permalink to &quot;ä¸ƒã€ä¸­æ­¢è¯·æ±‚&quot;">â€‹</a></h2><p>é€šè¿‡ <code>route.abort()</code> æ–¹æ³•ï¼Œå¯æ‹¦æˆªç‰¹å®šè¯·æ±‚å¹¶ç›´æ¥ä¸­æ­¢ï¼ˆä¸å‘èµ·å®é™…è¯·æ±‚ï¼‰ï¼Œé€‚ç”¨äºå±è”½ä¸å¿…è¦çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€å¹¿å‘Šç­‰ï¼‰ã€‚</p><h3 id="ç¤ºä¾‹1-ä¸­æ­¢å›¾ç‰‡è¯·æ±‚-æŒ‰æ–‡ä»¶åç¼€" tabindex="-1">ç¤ºä¾‹1ï¼šä¸­æ­¢å›¾ç‰‡è¯·æ±‚ï¼ˆæŒ‰æ–‡ä»¶åç¼€ï¼‰ <a class="header-anchor" href="#ç¤ºä¾‹1-ä¸­æ­¢å›¾ç‰‡è¯·æ±‚-æŒ‰æ–‡ä»¶åç¼€" aria-label="Permalink to &quot;ç¤ºä¾‹1ï¼šä¸­æ­¢å›¾ç‰‡è¯·æ±‚ï¼ˆæŒ‰æ–‡ä»¶åç¼€ï¼‰&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-11" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-11" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‹¦æˆªæ‰€æœ‰åç¼€ä¸º png/jpg/jpeg çš„è¯·æ±‚ï¼Œç›´æ¥ä¸­æ­¢ï¼ˆä¸åŠ è½½å›¾ç‰‡ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.route(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/*.{png,jpg,jpeg}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.abort())</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-11" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-11" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥æ‹¦æˆªå›¾ç‰‡è¯·æ±‚å¹¶ä¸­æ­¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.route(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/*.{png,jpg,jpeg}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.abort())</span></span></code></pre></div><h3 id="ç¤ºä¾‹2-æŒ‰èµ„æºç±»å‹ä¸­æ­¢è¯·æ±‚" tabindex="-1">ç¤ºä¾‹2ï¼šæŒ‰èµ„æºç±»å‹ä¸­æ­¢è¯·æ±‚ <a class="header-anchor" href="#ç¤ºä¾‹2-æŒ‰èµ„æºç±»å‹ä¸­æ­¢è¯·æ±‚" aria-label="Permalink to &quot;ç¤ºä¾‹2ï¼šæŒ‰èµ„æºç±»å‹ä¸­æ­¢è¯·æ±‚&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-12" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-12" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼šè‹¥èµ„æºç±»å‹ä¸º &quot;image&quot; åˆ™ä¸­æ­¢ï¼Œå¦åˆ™ç»§ç»­</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.route(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;**/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.abort() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.request.resource_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;image&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.continue_()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-12" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-12" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥æ‹¦æˆªè¯·æ±‚ï¼ŒæŒ‰èµ„æºç±»å‹åˆ¤æ–­æ˜¯å¦ä¸­æ­¢</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.route(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;**/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route: route.abort() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.request.resource_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;image&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.continue_()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="å…«ã€ä¿®æ”¹å“åº”" tabindex="-1">å…«ã€ä¿®æ”¹å“åº” <a class="header-anchor" href="#å…«ã€ä¿®æ”¹å“åº”" aria-label="Permalink to &quot;å…«ã€ä¿®æ”¹å“åº”&quot;">â€‹</a></h2><p>é€šè¿‡ <code>route.fetch()</code> å…ˆè·å–åŸå§‹å“åº”ï¼Œä¿®æ”¹å“åº”å†…å®¹ï¼ˆå¦‚å“åº”ä½“ã€å“åº”å¤´ï¼‰åï¼Œå†é€šè¿‡ <code>route.fulfill()</code> è¿”å›è‡ªå®šä¹‰å“åº”ç»™é¡µé¢ã€‚</p><h3 id="ç¤ºä¾‹-ä¿®æ”¹é¡µé¢æ ‡é¢˜-æ·»åŠ å‰ç¼€" tabindex="-1">ç¤ºä¾‹ï¼šä¿®æ”¹é¡µé¢æ ‡é¢˜ï¼ˆæ·»åŠ å‰ç¼€ï¼‰ <a class="header-anchor" href="#ç¤ºä¾‹-ä¿®æ”¹é¡µé¢æ ‡é¢˜-æ·»åŠ å‰ç¼€" aria-label="Permalink to &quot;ç¤ºä¾‹ï¼šä¿®æ”¹é¡µé¢æ ‡é¢˜ï¼ˆæ·»åŠ å‰ç¼€ï¼‰&quot;">â€‹</a></h3><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-13" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-13" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright.sync_api </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Route</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handle_route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(route: Route) -&gt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 1. è·å–åŸå§‹å“åº”ï¼ˆä¸ç›´æ¥è¿”å›ç»™é¡µé¢ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.fetch()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 2. ä¿®æ”¹å“åº”ä½“ï¼šåœ¨ &lt;title&gt; æ ‡ç­¾å‰æ·»åŠ å‰ç¼€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.text()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è·å–åŸå§‹å“åº”ä½“ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    modified_body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body.replace(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;title&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;title&gt;My prefix:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¿®æ”¹æ ‡é¢˜</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 3. è¿”å›è‡ªå®šä¹‰å“åº”ï¼ˆå¤ç”¨åŸå§‹å“åº”çš„å¤§éƒ¨åˆ†å‚æ•°ï¼Œä»…è¦†ç›– body å’Œ headersï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    route.fulfill(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¤ç”¨åŸå§‹å“åº”çš„çŠ¶æ€ç ã€å¤§éƒ¨åˆ†å¤´ä¿¡æ¯ç­‰</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        body</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">modified_body,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¦†ç›–å“åº”ä½“ï¼ˆä½¿ç”¨ä¿®æ”¹åçš„å†…å®¹ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.headers, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content-type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text/html&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼ºåˆ¶è®¾ç½® Content-Type ä¸º html</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‹¦æˆª URL åŒ¹é… &quot;**/title.html&quot; çš„è¯·æ±‚ï¼Œåº”ç”¨å“åº”ä¿®æ”¹é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.route(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/title.html&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handle_route)</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-13" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-13" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright.async_api </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Route</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handle_route</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(route: Route) -&gt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 1. å¼‚æ­¥è·å–åŸå§‹å“åº”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.fetch()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 2. å¼‚æ­¥è·å–å“åº”ä½“å¹¶ä¿®æ”¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.text()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    modified_body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body.replace(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;title&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;title&gt;My prefix:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 3. å¼‚æ­¥è¿”å›è‡ªå®šä¹‰å“åº”</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> route.fulfill(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        body</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">modified_body,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.headers, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content-type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text/html&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥æ‹¦æˆªè¯·æ±‚å¹¶åº”ç”¨å“åº”ä¿®æ”¹é€»è¾‘</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.route(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**/title.html&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handle_route)</span></span></code></pre></div><h2 id="ä¹ã€glob-url-æ¨¡å¼" tabindex="-1">ä¹ã€Glob URL æ¨¡å¼ <a class="header-anchor" href="#ä¹ã€glob-url-æ¨¡å¼" aria-label="Permalink to &quot;ä¹ã€Glob URL æ¨¡å¼&quot;">â€‹</a></h2><p>Playwright çš„ç½‘ç»œæ‹¦æˆªæ–¹æ³•ï¼ˆå¦‚ <code>page.route()</code>ã€<code>page.expect_response()</code>ï¼‰ä½¿ç”¨<strong>ç®€åŒ–çš„ Glob æ¨¡å¼</strong>åŒ¹é… URLï¼Œæ”¯æŒä»¥ä¸‹é€šé…ç¬¦è§„åˆ™ï¼š</p><table tabindex="0"><thead><tr><th>é€šé…ç¬¦</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td><code>*</code></td><td>åŒ¹é…é™¤ <code>/</code> å¤–çš„ä»»æ„å­—ç¬¦ï¼ˆå•å±‚çº§ï¼‰</td></tr><tr><td><code>**</code></td><td>åŒ¹é…åŒ…æ‹¬ <code>/</code> åœ¨å†…çš„ä»»æ„å­—ç¬¦ï¼ˆå¤šå±‚çº§ï¼Œå¦‚è·¨ç›®å½•ï¼‰</td></tr><tr><td><code>?</code></td><td>ä»…åŒ¹é…å­—é¢é‡ <code>?</code>ï¼ˆä¸åŒ¹é…å…¶ä»–å­—ç¬¦ï¼ŒåŒ¹é…ä»»æ„å­—ç¬¦éœ€ç”¨ <code>*</code>ï¼‰</td></tr><tr><td><code>{}</code></td><td>åŒ¹é…æ‹¬å·å†…ç”¨é€—å·åˆ†éš”çš„é€‰é¡¹åˆ—è¡¨ï¼ˆå¦‚ <code>{png,jpg}</code> åŒ¹é… png æˆ– jpgï¼‰</td></tr><tr><td><code>\\</code></td><td>è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ <code>\\*</code> åŒ¹é…å­—é¢é‡ <code>*</code>ï¼Œæ³¨æ„åœ¨ä»£ç ä¸­éœ€å†™ä¸º <code>\\\\*</code>ï¼‰</td></tr></tbody></table><h3 id="ç¤ºä¾‹ä¸è¯´æ˜" tabindex="-1">ç¤ºä¾‹ä¸è¯´æ˜ <a class="header-anchor" href="#ç¤ºä¾‹ä¸è¯´æ˜" aria-label="Permalink to &quot;ç¤ºä¾‹ä¸è¯´æ˜&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Glob æ¨¡å¼</th><th>åŒ¹é…ç»“æœ</th><th>ä¸åŒ¹é…ç»“æœ</th></tr></thead><tbody><tr><td><code>https://example.com/*.js</code></td><td><code>https://example.com/file.js</code>ï¼ˆå•å±‚çº§ JS æ–‡ä»¶ï¼‰</td><td><code>https://example.com/path/file.js</code>ï¼ˆå¤šå±‚çº§ï¼‰</td></tr><tr><td><code>https://example.com/?page=1</code></td><td><code>https://example.com/?page=1</code>ï¼ˆå«æŒ‡å®šæŸ¥è¯¢å‚æ•°ï¼‰</td><td><code>https://example.com</code>ï¼ˆæ— æŸ¥è¯¢å‚æ•°ï¼‰</td></tr><tr><td><code>**/*.js</code></td><td><code>https://example.com/file.js</code>ã€<code>https://example.com/path/file.js</code>ï¼ˆä»»æ„å±‚çº§ JS æ–‡ä»¶ï¼‰</td><td>-</td></tr><tr><td><code>**/*.{png,jpg,jpeg}</code></td><td>æ‰€æœ‰åç¼€ä¸º pngã€jpgã€jpeg çš„æ–‡ä»¶ï¼ˆå¦‚ <code>https://a.com/img.png</code>ï¼‰</td><td><code>https://a.com/img.gif</code>ï¼ˆå…¶ä»–åç¼€ï¼‰</td></tr></tbody></table><h3 id="é‡è¦æ³¨æ„äº‹é¡¹" tabindex="-1">é‡è¦æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#é‡è¦æ³¨æ„äº‹é¡¹" aria-label="Permalink to &quot;é‡è¦æ³¨æ„äº‹é¡¹&quot;">â€‹</a></h3><ol><li>Glob æ¨¡å¼å¿…é¡»åŒ¹é…<strong>å®Œæ•´ URL</strong>ï¼ˆåŒ…æ‹¬åè®®ã€åŸŸåã€è·¯å¾„ï¼‰ï¼Œè€Œééƒ¨åˆ†ç‰‡æ®µï¼›</li><li>å¤æ‚åŒ¹é…åœºæ™¯ï¼ˆå¦‚åŠ¨æ€å‚æ•°ã€å¤šæ¡ä»¶ç»„åˆï¼‰å»ºè®®ä½¿ç”¨ <strong>æ­£åˆ™è¡¨è¾¾å¼ï¼ˆRegExpï¼‰</strong> æ›¿ä»£ Glob æ¨¡å¼ï¼›</li><li>åŒ¹é…æ—¶éœ€æ³¨æ„ URL çš„å¤§å°å†™ï¼ˆGlob æ¨¡å¼é»˜è®¤åŒºåˆ†å¤§å°å†™ï¼‰ã€‚</li></ol><h2 id="åã€websockets" tabindex="-1">åã€WebSockets <a class="header-anchor" href="#åã€websockets" aria-label="Permalink to &quot;åã€WebSockets&quot;">â€‹</a></h2><p>Playwright åŸç”Ÿæ”¯æŒ WebSocket çš„<strong>æ£€æŸ¥ã€æ¨¡æ‹Ÿå’Œä¿®æ”¹</strong>ï¼Œå…·ä½“æ¨¡æ‹Ÿæ–¹æ³•å¯å‚è€ƒ <a href="https://playwright.net.cn/python/docs/mock" target="_blank" rel="noreferrer">API æ¨¡æ‹ŸæŒ‡å—</a>ã€‚</p><h3 id="ç›‘æ§-websocket-äº‹ä»¶" tabindex="-1">ç›‘æ§ WebSocket äº‹ä»¶ <a class="header-anchor" href="#ç›‘æ§-websocket-äº‹ä»¶" aria-label="Permalink to &quot;ç›‘æ§ WebSocket äº‹ä»¶&quot;">â€‹</a></h3><p>é€šè¿‡ <code>page.on(&quot;websocket&quot;)</code> è®¢é˜… WebSocket åˆ›å»ºäº‹ä»¶ï¼Œå¯è¿›ä¸€æ­¥ç›‘æ§ WebSocket çš„<strong>å‘é€å¸§ï¼ˆframesentï¼‰</strong>ã€<strong>æ¥æ”¶å¸§ï¼ˆframereceivedï¼‰</strong> å’Œ<strong>å…³é—­ï¼ˆcloseï¼‰</strong> äº‹ä»¶ã€‚</p><h4 id="åŒæ­¥ä»£ç ç¤ºä¾‹-sync-14" tabindex="-1">åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰ <a class="header-anchor" href="#åŒæ­¥ä»£ç ç¤ºä¾‹-sync-14" aria-label="Permalink to &quot;åŒæ­¥ä»£ç ç¤ºä¾‹ï¼ˆSyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰ WebSocket å¤„ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> on_web_socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # WebSocket è¿æ¥æ‰“å¼€æ—¶æ‰“å° URL</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WebSocket opened: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ws.url</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ç›‘æ§å‘é€å¸§äº‹ä»¶ï¼šæ‰“å°å‘é€çš„ payload</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ws.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;framesent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Sent frame: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">payload</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ç›‘æ§æ¥æ”¶å¸§äº‹ä»¶ï¼šæ‰“å°æ¥æ”¶çš„ payload</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ws.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;framereceived&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Received frame: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">payload</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ç›‘æ§å…³é—­äº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ws.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;close&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WebSocket closed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¢é˜… WebSocket åˆ›å»ºäº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;websocket&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, on_web_socket)</span></span></code></pre></div><h4 id="å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-14" tabindex="-1">å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰ <a class="header-anchor" href="#å¼‚æ­¥ä»£ç ç¤ºä¾‹-async-14" aria-label="Permalink to &quot;å¼‚æ­¥ä»£ç ç¤ºä¾‹ï¼ˆAsyncï¼‰&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰ WebSocket å¤„ç†å‡½æ•°ï¼ˆå¼‚æ­¥åœºæ™¯ä¸‹é€»è¾‘ä¸åŒæ­¥ä¸€è‡´ï¼Œæ— éœ€ awaitï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> on_web_socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ws):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WebSocket opened: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ws.url</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ws.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;framesent&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Sent frame: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">payload</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ws.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;framereceived&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Received frame: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">payload</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ws.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;close&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WebSocket closed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¢é˜… WebSocket åˆ›å»ºäº‹ä»¶</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">page.on(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;websocket&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, on_web_socket)</span></span></code></pre></div><h2 id="åä¸€ã€ä¸¢å¤±çš„ç½‘ç»œäº‹ä»¶ä¸æœåŠ¡å·¥ä½œçº¿ç¨‹-service-workers" tabindex="-1">åä¸€ã€ä¸¢å¤±çš„ç½‘ç»œäº‹ä»¶ä¸æœåŠ¡å·¥ä½œçº¿ç¨‹ï¼ˆService Workersï¼‰ <a class="header-anchor" href="#åä¸€ã€ä¸¢å¤±çš„ç½‘ç»œäº‹ä»¶ä¸æœåŠ¡å·¥ä½œçº¿ç¨‹-service-workers" aria-label="Permalink to &quot;åä¸€ã€ä¸¢å¤±çš„ç½‘ç»œäº‹ä»¶ä¸æœåŠ¡å·¥ä½œçº¿ç¨‹ï¼ˆService Workersï¼‰&quot;">â€‹</a></h2><p>è‹¥ä½¿ç”¨ <code>browser_context.route()</code> æˆ– <code>page.route()</code> æ—¶å‘ç°<strong>ç½‘ç»œäº‹ä»¶ä¸¢å¤±</strong>ï¼Œå¯èƒ½æ˜¯æœåŠ¡å·¥ä½œçº¿ç¨‹ï¼ˆService Workersï¼‰æ¥ç®¡äº†ç½‘ç»œè¯·æ±‚å¯¼è‡´ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³ï¼š</p><h3 id="_1-ç¦ç”¨-service-workers" tabindex="-1">1. ç¦ç”¨ Service Workers <a class="header-anchor" href="#_1-ç¦ç”¨-service-workers" aria-label="Permalink to &quot;1. ç¦ç”¨ Service Workers&quot;">â€‹</a></h3><p>åœ¨åˆ›å»ºæµè§ˆå™¨ä¸Šä¸‹æ–‡æ—¶ï¼Œå°† <code>service_workers</code> è®¾ç½®ä¸º <code>&#39;block&#39;</code>ï¼Œé˜»æ­¢ Service Workers è¿è¡Œï¼š</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åŒæ­¥ç¤ºä¾‹ï¼šåˆ›å»ºç¦ç”¨ Service Workers çš„ä¸Šä¸‹æ–‡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.new_context(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">service_workers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;block&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¼‚æ­¥ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> browser.new_context(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">service_workers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;block&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="_2-é¿å…ä¸ç¬¬ä¸‰æ–¹æ¨¡æ‹Ÿå·¥å…·å†²çª" tabindex="-1">2. é¿å…ä¸ç¬¬ä¸‰æ–¹æ¨¡æ‹Ÿå·¥å…·å†²çª <a class="header-anchor" href="#_2-é¿å…ä¸ç¬¬ä¸‰æ–¹æ¨¡æ‹Ÿå·¥å…·å†²çª" aria-label="Permalink to &quot;2. é¿å…ä¸ç¬¬ä¸‰æ–¹æ¨¡æ‹Ÿå·¥å…·å†²çª&quot;">â€‹</a></h3><p>è‹¥ä½¿ç”¨ Mock Service Worker (MSW) ç­‰ç¬¬ä¸‰æ–¹æ¨¡æ‹Ÿå·¥å…·ï¼Œå…¶ä¼šé€šè¿‡ Service Workers æ¥ç®¡è¯·æ±‚ï¼Œå¯¼è‡´ Playwright çš„ <code>route()</code> æ— æ³•æ•è·äº‹ä»¶ã€‚å»ºè®®ï¼š</p><ul><li>ä¼˜å…ˆä½¿ç”¨ Playwright å†…ç½®çš„ <code>browser_context.route()</code> æˆ– <code>page.route()</code> è¿›è¡Œå“åº”æ¨¡æ‹Ÿï¼›</li><li>è‹¥éœ€åŒæ—¶ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œéœ€ç¡®ä¿å…¶ä¸å½±å“ Playwright çš„ç½‘ç»œæ‹¦æˆªé€»è¾‘ã€‚</li></ul><h3 id="_3-ç›‘å¬-service-workers-å‘èµ·çš„è¯·æ±‚" tabindex="-1">3. ç›‘å¬ Service Workers å‘èµ·çš„è¯·æ±‚ <a class="header-anchor" href="#_3-ç›‘å¬-service-workers-å‘èµ·çš„è¯·æ±‚" aria-label="Permalink to &quot;3. ç›‘å¬ Service Workers å‘èµ·çš„è¯·æ±‚&quot;">â€‹</a></h3><p>è‹¥éœ€ç›‘æ§ Service Workers æœ¬èº«å‘èµ·çš„è¯·æ±‚ï¼Œå¯å‚è€ƒ Playwright çš„ <a href="https://playwright.dev/docs/service-workers" target="_blank" rel="noreferrer">å®éªŒæ€§åŠŸèƒ½æ–‡æ¡£</a>ï¼ˆéœ€æ³¨æ„å®éªŒæ€§åŠŸèƒ½å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼‰ã€‚</p>`,120)])])}const g=i(h,[["render",l]]);export{o as __pageData,g as default};
